@using MudBlazor
@inject ISnackbar Snackbar

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Cancel" Class="mr-2" />
            Skip Workout
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudText Typo="Typo.subtitle2" Class="mb-4">@Session.SessionName - @Session.ScheduledDate.ToString("MMM dd, yyyy")</MudText>

        <MudAlert Severity="Severity.Info" Dense="true" Class="mb-4">
            It's okay to skip workouts! Rest and recovery are important parts of training.
        </MudAlert>

        <MudTextField @bind-Value="SkipReason"
                      Label="Reason (optional)"
                      Variant="Variant.Outlined"
                      Lines="3"
                      Placeholder="e.g., Not feeling well, injury prevention, schedule conflict..."
                      Class="mb-2" />
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Warning" Variant="Variant.Filled" OnClick="Submit">
            Skip Workout
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter]
    private dynamic? Dialog { get; set; }

    [Parameter]
    public SessionDetailDto Session { get; set; } = null!;

    private string? SkipReason { get; set; }

    private void Cancel()
    {
        Dialog?.Cancel();
    }

    private void Submit()
    {
        var skipRequest = new
        {
            SkipReason
        };

        Dialog?.Close(DialogResult.Ok(skipRequest));
    }

    public class SessionDetailDto
    {
        public Guid Id { get; set; }
        public string SessionName { get; set; } = string.Empty;
        public DateTime ScheduledDate { get; set; }
    }
}
